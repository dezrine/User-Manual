<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayFlow User Manual - Interactive FlipBook</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow-x: hidden;
        }

        .title-bar {
            color: white;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .controls button {
            padding: 12px 28px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-nav {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-nav:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.5);
        }

        .btn-nav:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .btn-pdf {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(56, 239, 125, 0.3);
        }

        .btn-pdf:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(56, 239, 125, 0.5);
        }

        .page-indicator {
            background: rgba(255,255,255,0.95);
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            color: #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* Book Container */
        .book-wrapper {
            perspective: 3000px;
            margin: 20px 0;
        }

        .book {
            width: 1100px;
            height: 650px;
            position: relative;
            transform-style: preserve-3d;
        }

        .book::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            width: 6px;
            height: 100%;
            background: linear-gradient(to right, #222 0%, #555 50%, #222 100%);
            transform: translateX(-50%);
            z-index: 100;
            box-shadow: 0 0 30px rgba(0,0,0,0.6);
        }

        .page {
            position: absolute;
            width: 50%;
            height: 100%;
            top: 0;
            background: #fff;
            overflow: hidden;
            transition: transform 0.7s cubic-bezier(0.645, 0.045, 0.355, 1);
            transform-style: preserve-3d;
            box-shadow: 0 0 25px rgba(0,0,0,0.2);
        }

        .page-left {
            left: 0;
            border-radius: 10px 0 0 10px;
            transform-origin: right center;
            background: linear-gradient(to right, #f0f0f0 0%, #fff 100%);
        }

        .page-right {
            right: 0;
            border-radius: 0 10px 10px 0;
            transform-origin: left center;
            background: linear-gradient(to left, #f0f0f0 0%, #fff 100%);
        }

        .page-right.flipping {
            animation: flipRight 0.7s ease-in-out forwards;
            z-index: 1000;
        }

        .page-left.flipping-back {
            animation: flipLeft 0.7s ease-in-out forwards;
            z-index: 1000;
        }

        @keyframes flipRight {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(-180deg); }
        }

        @keyframes flipLeft {
            0% { transform: rotateY(-180deg); }
            100% { transform: rotateY(0deg); }
        }

        .page-inner {
            position: absolute;
            width: 100%;
            height: 100%;
            padding: 30px 25px;
            backface-visibility: hidden;
            overflow-y: auto;
        }

        /* Two Column Layout per page */
        .two-column {
            column-count: 2;
            column-gap: 25px;
            column-rule: 1px solid #e0e0e0;
            height: 100%;
        }

        .page-left::after {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            width: 40px;
            height: 100%;
            background: linear-gradient(to left, rgba(0,0,0,0.15) 0%, transparent 100%);
            pointer-events: none;
        }

        .page-right::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 40px;
            height: 100%;
            background: linear-gradient(to right, rgba(0,0,0,0.15) 0%, transparent 100%);
            pointer-events: none;
            z-index: 1;
        }

        .page-number {
            position: absolute;
            bottom: 15px;
            font-size: 11px;
            color: #888;
            font-style: italic;
        }

        .page-left .page-number { left: 25px; }
        .page-right .page-number { right: 25px; }

        /* Content Styling */
        .page-content {
            font-size: 10px;
            line-height: 1.5;
            color: #333;
        }

        .page-content h1 {
            font-size: 16px;
            color: #4f46e5;
            margin-bottom: 10px;
            border-bottom: 2px solid #4f46e5;
            padding-bottom: 5px;
            column-span: all;
        }

        .page-content h2 {
            font-size: 12px;
            color: #7c3aed;
            margin: 12px 0 8px 0;
            border-left: 3px solid #9333ea;
            padding-left: 8px;
        }

        .page-content h3 {
            font-size: 11px;
            color: #1a1a1a;
            margin: 10px 0 6px 0;
        }

        .page-content p {
            margin-bottom: 8px;
            text-align: justify;
        }

        .page-content ul, .page-content ol {
            margin: 6px 0;
            padding-left: 18px;
        }

        .page-content li {
            margin-bottom: 4px;
        }

        .page-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 8px 0;
            font-size: 9px;
            break-inside: avoid;
        }

        .page-content th, .page-content td {
            border: 1px solid #ddd;
            padding: 4px 6px;
            text-align: left;
        }

        .page-content th {
            background: #f3f4f6;
            color: #4f46e5;
            font-weight: bold;
        }

        .note, .tip, .warning, .danger {
            padding: 8px 10px;
            margin: 10px 0;
            font-size: 9px;
            border-radius: 4px;
            break-inside: avoid;
        }

        .note { background: #eff6ff; border-left: 3px solid #3b82f6; }
        .tip { background: #ecfdf5; border-left: 3px solid #10b981; }
        .warning { background: #fef3c7; border-left: 3px solid #f59e0b; }
        .danger { background: #fee2e2; border-left: 3px solid #ef4444; }

        .feature-box {
            background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
            border: 1px solid #c4b5fd;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            break-inside: avoid;
        }

        .feature-box h4 {
            color: #7c3aed;
            margin: 0 0 4px 0;
            font-size: 11px;
        }

        /* Cover styling */
        .cover-page {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            text-align: center;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #9333ea 100%);
            color: white;
            border-radius: 10px;
        }

        .cover-page.back-cover {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }

        .cover-logo { font-size: 64px; margin-bottom: 15px; }
        .cover-page h1 { font-size: 32px; border: none; color: white; margin-bottom: 8px; }
        .cover-subtitle { font-size: 16px; opacity: 0.9; }
        .cover-version { margin-top: 40px; font-size: 11px; opacity: 0.7; }

        .toc-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            border-bottom: 1px dotted #ccc;
            font-size: 10px;
        }
        .toc-chapter { font-weight: bold; color: #4f46e5; margin-top: 6px; }

        .chapter-header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 2px double #4f46e5;
            margin-bottom: 15px;
            column-span: all;
        }
        .chapter-number { font-size: 10px; color: #9333ea; text-transform: uppercase; letter-spacing: 2px; }
        .chapter-title { font-size: 18px; color: #4f46e5; margin-top: 5px; }

        .steps {
            counter-reset: step;
            list-style: none;
            padding-left: 0;
        }
        .steps li {
            counter-increment: step;
            padding-left: 24px;
            position: relative;
            margin-bottom: 6px;
        }
        .steps li::before {
            content: counter(step);
            position: absolute;
            left: 0;
            background: #4f46e5;
            color: white;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            text-align: center;
            line-height: 16px;
            font-size: 9px;
            font-weight: bold;
        }

        .click-zone {
            position: absolute;
            top: 0;
            width: 80px;
            height: 100%;
            cursor: pointer;
            z-index: 50;
        }
        .click-zone.left { left: 0; }
        .click-zone.right { right: 0; }
        .click-zone:hover { background: rgba(102, 126, 234, 0.05); }

        .loading-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
            color: white;
        }
        .loading-overlay.active { display: flex; }
        .spinner {
            width: 50px; height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top-color: #38ef7d;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        .page-inner::-webkit-scrollbar { width: 4px; }
        .page-inner::-webkit-scrollbar-track { background: #f1f1f1; }
        .page-inner::-webkit-scrollbar-thumb { background: #c4b5fd; border-radius: 2px; }

        .instructions {
            color: rgba(255,255,255,0.7);
            font-size: 12px;
            margin-top: 15px;
        }

        .pdf-content { display: none; }

        @media (max-width: 1150px) {
            .book { width: 95vw; height: 56vw; }
            .page-content { font-size: 8px; }
        }
    </style>
</head>
<body>

<div class="title-bar">üìä PayFlow User Manual</div>

<div class="controls">
    <button class="btn-nav" id="prevBtn" onclick="prevPage()">‚óÄ Previous</button>
    <div class="page-indicator">
        Pages <span id="currentSpread">1-2</span> of <span id="totalPages">14</span>
    </div>
    <button class="btn-nav" id="nextBtn" onclick="nextPage()">Next ‚ñ∂</button>
    <button class="btn-pdf" onclick="exportToPDF()">üìÑ Export PDF</button>
</div>

<div class="book-wrapper">
    <div class="book" id="book">
        <div class="page page-left" id="leftPage">
            <div class="page-inner" id="leftContent"></div>
            <div class="page-number" id="leftPageNum"></div>
            <div class="click-zone left" onclick="prevPage()"></div>
        </div>
        <div class="page page-right" id="rightPage">
            <div class="page-inner" id="rightContent"></div>
            <div class="page-number" id="rightPageNum"></div>
            <div class="click-zone right" onclick="nextPage()"></div>
        </div>
    </div>
</div>

<div class="instructions">Click page edges or use ‚Üê ‚Üí arrow keys to turn pages</div>

<div class="loading-overlay" id="loadingOverlay">
    <div class="spinner"></div>
    <div>Generating PDF...</div>
</div>

<div class="pdf-content" id="pdfContent"></div>

<script>
// 14 pages total (each with 2 columns)
const pageContents = [
    // Page 1 - Cover
    `<div class="cover-page">
        <div class="cover-logo">üìä</div>
        <h1 style="border:none;color:white;">PayFlow</h1>
        <div class="cover-subtitle">Payroll & HR Management System</div>
        <div class="cover-subtitle" style="font-size:22px;margin-top:15px;">User Manual</div>
        <div class="cover-version">
            <p>Version 1.0</p>
            <p>December 2025</p>
        </div>
    </div>`,
    
    // Page 2 - TOC
    `<div class="page-content two-column">
        <h1>Table of Contents</h1>
        <div class="toc-item toc-chapter"><span>Chapter 1: Introduction</span><span>3</span></div>
        <div class="toc-item"><span>‚Ä¢ About PayFlow & Features</span><span>3</span></div>
        <div class="toc-item toc-chapter"><span>Chapter 2: Getting Started</span><span>4</span></div>
        <div class="toc-item"><span>‚Ä¢ Creating Account & Login</span><span>4</span></div>
        <div class="toc-item"><span>‚Ä¢ User Roles</span><span>4</span></div>
        <div class="toc-item toc-chapter"><span>Chapter 3: Employee Guide</span><span>5</span></div>
        <div class="toc-item"><span>‚Ä¢ Dashboard & Clock In/Out</span><span>5</span></div>
        <div class="toc-item"><span>‚Ä¢ Hours, Payslips & Calculator</span><span>6</span></div>
        <div class="toc-item"><span>‚Ä¢ Task Management</span><span>6</span></div>
        <div class="toc-item"><span>‚Ä¢ Requests & Budget</span><span>6</span></div>
        <div class="toc-item toc-chapter"><span>Chapter 4: Admin Guide</span><span>7</span></div>
        <div class="toc-item"><span>‚Ä¢ Payroll Generation</span><span>7</span></div>
        <div class="toc-item"><span>‚Ä¢ Employee Management</span><span>8</span></div>
        <div class="toc-item"><span>‚Ä¢ Registration Keys & Approval</span><span>8</span></div>
        <div class="toc-item"><span>‚Ä¢ Security & Compliance</span><span>9</span></div>
        <div class="toc-item"><span>‚Ä¢ Reports & Maintenance</span><span>9</span></div>
        <div class="toc-item toc-chapter"><span>Chapter 5: Executive Guide</span><span>10</span></div>
        <div class="toc-item"><span>‚Ä¢ Financial Statements</span><span>10</span></div>
        <div class="toc-item"><span>‚Ä¢ CEO Announcements</span><span>11</span></div>
        <div class="toc-item"><span>‚Ä¢ Meeting Scheduling</span><span>11</span></div>
        <div class="toc-item toc-chapter"><span>Chapter 6: Jamaican Tax Guide</span><span>12</span></div>
        <div class="toc-item toc-chapter"><span>Appendix: FAQ & Troubleshooting</span><span>13</span></div>
        <div class="toc-item"><span>‚Ä¢ Extended FAQ & Support</span><span>13</span></div>
    </div>`,
    
    // Page 3 - Introduction
    `<div class="page-content two-column">
        <div class="chapter-header">
            <div class="chapter-number">Chapter 1</div>
            <div class="chapter-title">Introduction</div>
        </div>
        <h2>About PayFlow</h2>
        <p><strong>PayFlow</strong> is a comprehensive Payroll and Human Resource Management System designed for Jamaican businesses. It handles employee time tracking, payroll calculation with statutory deductions, payslip generation, employee data management, and financial reporting.</p>
        
        <h2>Key Features</h2>
        <div class="feature-box">
            <h4>‚è∞ Real-Time Time Tracking</h4>
            <p>Clock in/out with live session timer tracking hours in real-time.</p>
        </div>
        <div class="feature-box">
            <h4>üí∞ Automated Payroll</h4>
            <p>Calculate payroll instantly with JMD 700/hour rate and automatic deductions.</p>
        </div>
        <div class="feature-box">
            <h4>üìã Jamaican Tax Compliance</h4>
            <p>Built-in NIS, NHT, Education Tax, and PAYE calculations.</p>
        </div>
        <div class="feature-box">
            <h4>üîê Role-Based Security</h4>
            <p>Three user levels: Employee, Admin, CEO with appropriate access.</p>
        </div>
        <div class="feature-box">
            <h4>üìä Comprehensive Reporting</h4>
            <p>Generate salary lists, deduction summaries, and financial statements.</p>
        </div>
        <div class="feature-box">
            <h4>üîë Registration Key System</h4>
            <p>Secure Admin/CEO account creation with key-based registration and approval workflow.</p>
        </div>
        <div class="feature-box">
            <h4>üìÖ Meeting Scheduling</h4>
            <p>CEO can schedule staff meetings with audience selection (All or Admins Only).</p>
        </div>
        <div class="feature-box">
            <h4>‚úÖ Task Management</h4>
            <p>Modern task system for all users. Admins can assign tasks to employees.</p>
        </div>
    </div>`,
    
    // Page 4 - Getting Started
    `<div class="page-content two-column">
        <div class="chapter-header">
            <div class="chapter-number">Chapter 2</div>
            <div class="chapter-title">Getting Started</div>
        </div>
        <h2>Creating an Account</h2>
        <h3>Employee Account</h3>
        <ol class="steps">
            <li>Open PayFlow in your browser</li>
            <li>Click "Don't have an account? Sign Up"</li>
            <li>Enter Username and Password</li>
            <li>Enter Employee ID (e.g., E001)</li>
            <li>Select "Employee Account"</li>
            <li>Click "Create Account"</li>
        </ol>
        <h3>Admin/CEO Account</h3>
        <ol class="steps">
            <li>Get registration key from CEO</li>
            <li>Follow steps above but select "Admin" or "CEO"</li>
            <li>Enter the registration key when prompted</li>
            <li>Click "Create Account"</li>
            <li>Wait for admin approval before logging in</li>
        </ol>
        <div class="warning"><strong>Important:</strong> Admin/CEO accounts require a registration key and admin approval.</div>
        
        <h2>Logging In</h2>
        <ol class="steps">
            <li>Enter your Username</li>
            <li>Enter your Password</li>
            <li>Select your Role from dropdown</li>
            <li>Click "Sign In"</li>
        </ol>
        
        <h2>User Roles</h2>
        <table>
            <tr><th>Role</th><th>Access</th></tr>
            <tr><td>Employee</td><td>Clock, hours, payslips, calculator, requests</td></tr>
            <tr><td>Admin</td><td>+ Payroll, employees, reports, maintenance</td></tr>
            <tr><td>CEO</td><td>+ Financial statements, business budgets</td></tr>
        </table>
    </div>`,
    
    // Page 5 - Employee Dashboard & Clock
    `<div class="page-content two-column">
        <div class="chapter-header">
            <div class="chapter-number">Chapter 3</div>
            <div class="chapter-title">Employee Guide</div>
        </div>
        <h2>Employee Dashboard</h2>
        <p>Your home base showing work status and quick actions.</p>
        <table>
            <tr><th>Card</th><th>Shows</th></tr>
            <tr><td>Clock Status</td><td>Clocked in/out status</td></tr>
            <tr><td>Hours This Month</td><td>Total hours + estimated pay</td></tr>
            <tr><td>Hours Today</td><td>Today's hours</td></tr>
        </table>
        <p><strong>Quick Actions:</strong> Payslips, Benefits, Budget, Working Hours</p>
        <p><strong>Upcoming Meetings:</strong> Scheduled meetings appear here</p>
        <p><strong>My Tasks:</strong> Pending tasks assigned to you</p>
        
        <h2>Clock In/Out System</h2>
        <h3>How to Clock In</h3>
        <ol class="steps">
            <li>Go to "View Working Hours"</li>
            <li>Click green "Clock In" button</li>
            <li>Status shows "üü¢ Clocked In"</li>
        </ol>
        <h3>How to Clock Out</h3>
        <ol class="steps">
            <li>Go to "View Working Hours"</li>
            <li>Click red "Clock Out" button</li>
            <li>Review hours and pay earned</li>
        </ol>
        <div class="warning"><strong>Remember:</strong> Always clock out at end of shift!</div>
    </div>`,
    
    // Page 6 - Hours, Payslips, Calculator
    `<div class="page-content two-column">
        <h2>Viewing Working Hours</h2>
        <table>
            <tr><th>Summary</th><th>Shows</th></tr>
            <tr><td>Today's Hours</td><td>Hours today</td></tr>
            <tr><td>This Week</td><td>Weekly hours</td></tr>
            <tr><td>This Month</td><td>Monthly hours</td></tr>
            <tr><td>Est. Pay</td><td>Projected earnings</td></tr>
        </table>
        <p>Filter by date range and click "Generate Hours Report".</p>
        
        <h2>Accessing Payslips</h2>
        <ol class="steps">
            <li>Go to "Access Payslips"</li>
            <li>Select date range</li>
            <li>Click "Search & Retrieve"</li>
            <li>Click "View Details" for breakdown</li>
        </ol>
        
        <h2>Salary Calculator</h2>
        <table>
            <tr><th>Item</th><th>Calculation</th></tr>
            <tr><td>Gross Pay</td><td>Hours √ó JMD 700</td></tr>
            <tr><td>NIS</td><td>3% (cap JMD 3,000)</td></tr>
            <tr><td>NHT</td><td>2%</td></tr>
            <tr><td>Education Tax</td><td>2.25%</td></tr>
            <tr><td>PAYE</td><td>25% above threshold</td></tr>
        </table>
        
        <h2>Task Management</h2>
        <p>All users can create and manage tasks. Tasks appear on your dashboard.</p>
        <h3>Creating Tasks</h3>
        <ol class="steps">
            <li>Go to "Task Management" in sidebar</li>
            <li>Click "+ New Task"</li>
            <li>Enter title, description, due date, priority</li>
            <li>Click "Save Task"</li>
        </ol>
        <h3>Managing Tasks</h3>
        <p><strong>Filters:</strong> All, Pending, Completed, Assigned by Me</p>
        <p><strong>Priorities:</strong> Low, Medium, High, Urgent (color-coded)</p>
        <p><strong>Actions:</strong> Mark complete/incomplete, Edit, Delete</p>
        <div class="tip"><strong>Tip:</strong> Tasks assigned to you appear on your dashboard.</div>
        
        <h2>Requests & Budget</h2>
        <p><strong>Request:</strong> Tax summaries, NIS/NHT statements, employment letters, benefits.</p>
        <p><strong>Budget:</strong> Track expenses by category, see remaining balance.</p>
    </div>`,
    
    // Page 7 - Admin Payroll
    `<div class="page-content two-column">
        <div class="chapter-header">
            <div class="chapter-number">Chapter 4</div>
            <div class="chapter-title">Administrator Guide</div>
        </div>
        <h2>Payroll Generation</h2>
        <ol class="steps">
            <li>Go to "Payroll Generation"</li>
            <li>Select Start and End dates</li>
            <li>Click "Run Full Payroll Calculation"</li>
            <li>Review results</li>
            <li>Confirm to save records</li>
        </ol>
        <p>System automatically: fetches employees, retrieves attendance, calculates hours, applies JMD 700/hour, calculates deductions.</p>
        
        <h2>Payroll Options</h2>
        <table>
            <tr><th>Button</th><th>Function</th></tr>
            <tr><td>Payslips (All)</td><td>Printable payslips</td></tr>
            <tr><td>Payroll Summary</td><td>Totals & averages</td></tr>
            <tr><td>Payroll Journal</td><td>Accounting entries</td></tr>
            <tr><td>Export CSV</td><td>Download spreadsheet</td></tr>
        </table>
        
        <h2>Single Payslip Generation</h2>
        <ol class="steps">
            <li>Go to "Generate Payslips"</li>
            <li>Enter Employee ID</li>
            <li>Select date range</li>
            <li>Click "Preview" then "Generate & Save"</li>
        </ol>
    </div>`,
    
    // Page 8 - Employee Mgmt & Security
    `<div class="page-content two-column">
        <h2>Managing Employees</h2>
        <h3>Add Employee</h3>
        <ol class="steps">
            <li>Click "Add New Employee"</li>
            <li>Enter ID, Name, Username, Password</li>
            <li>Select Role</li>
            <li>Click "Save"</li>
        </ol>
        <h3>Edit Employee</h3>
        <ol class="steps">
            <li>Click "Edit" next to employee</li>
            <li>Modify fields (leave password blank to keep)</li>
            <li>Click "Save"</li>
        </ol>
        <h3>Assigning Tasks</h3>
        <ol class="steps">
            <li>Go to "Task Management"</li>
            <li>Click "+ New Task"</li>
            <li>Fill in task details</li>
            <li>Select employee from "Assign to" dropdown</li>
            <li>Click "Save Task"</li>
        </ol>
        <div class="danger"><strong>Warning:</strong> Deleting removes all attendance and payroll records permanently!</div>
        
        <h2>Registration Keys & Account Approval</h2>
        <h3>Generating Keys (CEO Only)</h3>
        <ol class="steps">
            <li>Go to "System Security"</li>
            <li>Click "Generate Admin Key" or "Generate CEO Key"</li>
            <li>Share the generated key with the person</li>
            <li>Key is displayed and listed as "Active"</li>
        </ol>
        <h3>Approving Accounts (Admin/CEO)</h3>
        <ol class="steps">
            <li>Go to "System Security"</li>
            <li>View "Pending Account Approvals" section</li>
            <li>Review account details</li>
            <li>Click "Approve" or "Reject"</li>
        </ol>
        <div class="note"><strong>Note:</strong> Rejected accounts are deleted. Approved accounts can log in immediately.</div>
        
        <h2>System Security</h2>
        <h3>Managing Roles</h3>
        <ol class="steps">
            <li>Go to "System Security"</li>
            <li>Use dropdowns to change roles</li>
            <li>Click "Save All Changes"</li>
        </ol>
        <h3>Handling Requests</h3>
        <p>View pending requests and click "Approve" or "Reject".</p>
        <h3>System Stats</h3>
        <p>Employee count, Admin count, Today's clock-ins, Pending requests.</p>
    </div>`,
    
    // Page 9 - Compliance, Reports, Maintenance
    `<div class="page-content two-column">
        <h2>Statutory Compliance</h2>
        <table>
            <tr><th>Deduction</th><th>Rate</th><th>Cap</th></tr>
            <tr><td>NIS</td><td>3%</td><td>JMD 3,000</td></tr>
            <tr><td>NHT</td><td>2%</td><td>None</td></tr>
            <tr><td>Education Tax</td><td>2.25%</td><td>None</td></tr>
            <tr><td>PAYE</td><td>25%</td><td>>JMD 1.5M/yr</td></tr>
        </table>
        <p>Click "Run Compliance Check" to verify all records.</p>
        
        <h2>System Reports</h2>
        <table>
            <tr><th>Report</th><th>Contents</th></tr>
            <tr><td>Salary List</td><td>All employees + pay</td></tr>
            <tr><td>Hours Summary</td><td>Attendance data</td></tr>
            <tr><td>Deductions</td><td>Statutory breakdown</td></tr>
            <tr><td>Tax Filing</td><td>TAJ format</td></tr>
        </table>
        
        <h2>System Maintenance</h2>
        <h3>Backup</h3>
        <p>Click "Run Manual Full Backup" to download JSON with all data.</p>
        <h3>Purge Records</h3>
        <p>Set date, click "Execute Purge", type "PURGE" to confirm.</p>
        <div class="danger"><strong>Warning:</strong> Purging is IRREVERSIBLE!</div>
    </div>`,
    
    // Page 10 - Executive Guide
    `<div class="page-content two-column">
        <div class="chapter-header">
            <div class="chapter-number">Chapter 5</div>
            <div class="chapter-title">Executive Guide</div>
        </div>
        <h2>Financial Statements</h2>
        <p><strong>Summary Cards:</strong> Total Gross Pay, Total Deductions, Total Net Pay, Total Hours</p>
        <table>
            <tr><th>Statement</th><th>Purpose</th></tr>
            <tr><td>General Ledger</td><td>Accounting entries (debits/credits)</td></tr>
            <tr><td>YTD Report</td><td>Year-to-date overview</td></tr>
            <tr><td>Monthly Summary</td><td>Specific month analysis</td></tr>
        </table>
        
        <h2>Business Budget</h2>
        <p><strong>Projection Periods:</strong></p>
        <ul>
            <li>Next Month ‚Äì 1 month</li>
            <li>Next Quarter ‚Äì 3 months</li>
            <li>Annual ‚Äì 12 months</li>
        </ul>
        <h3>Employer Costs</h3>
        <table>
            <tr><th>Cost</th><th>Description</th></tr>
            <tr><td>Wages</td><td>Gross pay</td></tr>
            <tr><td>Employer NIS</td><td>3%</td></tr>
            <tr><td>Employer NHT</td><td>3%</td></tr>
            <tr><td>Total</td><td>Full expenditure</td></tr>
        </table>
        <div class="note"><strong>Note:</strong> Projections based on 3-month averages.</div>
        
        <h2>CEO Announcements</h2>
        <p>CEO can send announcements to specific audiences.</p>
        <h3>Creating Announcement</h3>
        <ol class="steps">
            <li>Go to "System Updates/Notices"</li>
            <li>Click "+ New Announcement"</li>
            <li>Enter title and content</li>
            <li>Select type (Info, Success, Warning, Urgent)</li>
            <li>Select audience: "Everyone" or "Admins Only"</li>
            <li>Click "Post Announcement"</li>
        </ol>
        <div class="tip"><strong>Tip:</strong> "Admins Only" announcements are only visible to Admin and CEO users.</div>
        
        <h2>Meeting Scheduling</h2>
        <p>CEO can schedule staff meetings that appear in announcements and on dashboards.</p>
        <h3>Scheduling a Meeting</h3>
        <ol class="steps">
            <li>Go to "System Updates/Notices"</li>
            <li>Click "üìÖ Schedule Meeting"</li>
            <li>Enter meeting title and description</li>
            <li>Select date and time</li>
            <li>Choose audience: "General (All Staff)" or "Admins Only"</li>
            <li>Click "Schedule Meeting"</li>
        </ol>
        <p><strong>Result:</strong> Meeting appears in announcements and on all relevant user dashboards.</p>
    </div>`,
    
    // Page 11 - Tax Guide
    `<div class="page-content two-column">
        <div class="chapter-header">
            <div class="chapter-number">Chapter 6</div>
            <div class="chapter-title">Jamaican Tax Guide</div>
        </div>
        <h2>NIS (National Insurance)</h2>
        <div class="feature-box">
            <h4>Rate: 3% | Cap: JMD 3,000/month</h4>
            <p>Retirement, disability, survivor benefits</p>
        </div>
        <h2>NHT (National Housing Trust)</h2>
        <div class="feature-box">
            <h4>Rate: 2% | No Cap</h4>
            <p>Housing assistance program</p>
        </div>
        <h2>Education Tax</h2>
        <div class="feature-box">
            <h4>Rate: 2.25% | No Cap</h4>
            <p>Education funding</p>
        </div>
        <h2>PAYE (Pay As You Earn)</h2>
        <div class="feature-box">
            <h4>Rate: 25% above threshold</h4>
            <p>Annual: JMD 1,500,096 | Monthly: JMD 125,008</p>
        </div>
        <h2>Example: JMD 150,000/month</h2>
        <table>
            <tr><td>Gross Pay</td><td>JMD 150,000</td></tr>
            <tr><td>NIS (capped)</td><td>-JMD 3,000</td></tr>
            <tr><td>NHT</td><td>-JMD 3,000</td></tr>
            <tr><td>Education Tax</td><td>-JMD 3,375</td></tr>
            <tr><td>PAYE</td><td>-JMD 6,248</td></tr>
            <tr style="background:#dcfce7;font-weight:bold;"><td>Net Pay</td><td>JMD 134,377</td></tr>
        </table>
    </div>`,
    
    // Page 12 - FAQ
    `<div class="page-content two-column">
        <div class="chapter-header">
            <div class="chapter-number">Appendix</div>
            <div class="chapter-title">FAQ & Troubleshooting</div>
        </div>
        <h2>Troubleshooting</h2>
        <table>
            <tr><th>Problem</th><th>Solution</th></tr>
            <tr><td>"Account not found"</td><td>Check username, create account</td></tr>
            <tr><td>"Incorrect role"</td><td>Select correct role</td></tr>
            <tr><td>"Pending approval"</td><td>Wait for admin to approve your account</td></tr>
            <tr><td>"Invalid registration key"</td><td>Get valid key from CEO</td></tr>
            <tr><td>"Already clocked in"</td><td>Clock out first</td></tr>
            <tr><td>No payroll records</td><td>Generate payroll first</td></tr>
            <tr><td>Can't see announcement</td><td>Check if it's "Admins Only" (employees can't see)</td></tr>
        </table>
        
        <h2>Frequently Asked Questions</h2>
        <h3>General Questions</h3>
        <p><strong>Q: What is the hourly rate?</strong> A: All employees are paid JMD 700 per hour.</p>
        <p><strong>Q: How is pay calculated?</strong> A: Hours worked √ó JMD 700, minus statutory deductions (NIS, NHT, Education Tax, PAYE).</p>
        <p><strong>Q: When is payday?</strong> A: Check your dashboard for the scheduled payday date.</p>
        <p><strong>Q: Why are there deductions?</strong> A: Jamaican law requires NIS, NHT, Education Tax, and PAYE deductions.</p>
        
        <h3>Account & Access</h3>
        <p><strong>Q: How do I create an Admin account?</strong> A: Get a registration key from the CEO, enter it during signup, then wait for admin approval.</p>
        <p><strong>Q: Can employees see admin-only announcements?</strong> A: No, only "Everyone" announcements are visible to employees. "Admins Only" announcements are restricted.</p>
        <p><strong>Q: What if I forget my password?</strong> A: Contact your system administrator to reset your password.</p>
        
        <h3>Time Tracking</h3>
        <p><strong>Q: What if I forget to clock out?</strong> A: Contact your administrator to adjust the record manually.</p>
        <p><strong>Q: Can I clock in early?</strong> A: Yes, you can clock in at any time. The system tracks your actual hours.</p>
    </div>`,
    
    // Page 13 - More FAQ & Support
    `<div class="page-content two-column">
        <h2>Task Management FAQ</h2>
        <p><strong>Q: Who can assign tasks?</strong> A: Admins and CEO can assign tasks to employees. All users can create personal tasks.</p>
        <p><strong>Q: How do I mark a task as complete?</strong> A: Click the "Mark Complete" button on the task card, or go to Task Management and toggle the status.</p>
        <p><strong>Q: Can I edit tasks assigned to me?</strong> A: You can mark them complete/incomplete, but only the creator or an admin can edit task details.</p>
        <p><strong>Q: What are task priorities?</strong> A: Low (blue), Medium (yellow), High (orange), Urgent (red).</p>
        
        <h2>Meeting & Announcements FAQ</h2>
        <p><strong>Q: Where do meetings appear?</strong> A: Meetings appear in the announcements section and on all relevant user dashboards.</p>
        <p><strong>Q: Can I see meetings scheduled for admins only?</strong> A: Only if you are an Admin or CEO. Employees only see "General" meetings.</p>
        <p><strong>Q: How do I know if a meeting is for me?</strong> A: Check the audience badge - "All" means everyone, "Admins" means admins only.</p>
        
        <h2>Data & Security FAQ</h2>
        <p><strong>Q: Can deleted data be restored?</strong> A: No, deletions are permanent. Always backup your data before purging records.</p>
        <p><strong>Q: How often should I backup?</strong> A: Regular backups are recommended, especially before major operations like payroll generation or purging.</p>
        <p><strong>Q: Who can see my personal data?</strong> A: Employees can see their own data. Admins and CEO can see all employee data for management purposes.</p>
        
        <h2>Payroll FAQ</h2>
        <p><strong>Q: How often is payroll generated?</strong> A: Typically monthly, per your company's schedule. Check with your administrator.</p>
        <p><strong>Q: What if my hours are incorrect?</strong> A: Contact your administrator to review and correct your attendance records.</p>
        <p><strong>Q: When can I view my payslip?</strong> A: Payslips are available immediately after payroll is generated and saved by the administrator.</p>
        
        <div class="tip" style="margin-top:20px;">
            <strong>üí° Support:</strong> For additional help, contact your system administrator or refer to the System Updates section for announcements.
        </div>
        
        <div style="text-align:center;margin-top:30px;padding-top:20px;border-top:2px solid #ddd;">
            <p style="color:#888;font-size:9px;">PayFlow User Manual v1.0 | December 2025</p>
            <p style="color:#888;font-size:8px;">¬© 2025 PayFlow. All rights reserved.</p>
        </div>
    </div>`,
    
    // Page 14 - Back Cover
    `<div class="cover-page back-cover">
        <h1 style="border:none;color:white;font-size:28px;">PayFlow</h1>
        <div class="cover-subtitle" style="font-size:14px;margin-top:20px;">Payroll & HR Management System</div>
        <div class="cover-version" style="margin-top:60px;">
            <p style="font-size:12px;opacity:0.9;">User Manual v1.0</p>
            <p style="font-size:11px;opacity:0.8;margin-top:10px;">December 2025</p>
            <p style="font-size:10px;opacity:0.7;margin-top:30px;">¬© 2025 PayFlow</p>
            <p style="font-size:9px;opacity:0.6;margin-top:5px;">All rights reserved</p>
        </div>
    </div>`
];

let currentSpread = 0;
const totalPages = pageContents.length;
const totalSpreads = Math.ceil(totalPages / 2);
let isAnimating = false;

function initBook() {
    document.getElementById('totalPages').textContent = totalPages;
    displaySpread(currentSpread);
}

function displaySpread(spreadIndex) {
    const leftIdx = spreadIndex * 2;
    const rightIdx = spreadIndex * 2 + 1;
    
    const leftContent = document.getElementById('leftContent');
    const rightContent = document.getElementById('rightContent');
    const leftNum = document.getElementById('leftPageNum');
    const rightNum = document.getElementById('rightPageNum');
    
    leftContent.innerHTML = leftIdx < totalPages ? pageContents[leftIdx] : '';
    leftNum.textContent = leftIdx < totalPages && leftIdx > 0 ? leftIdx + 1 : '';
    
    rightContent.innerHTML = rightIdx < totalPages ? pageContents[rightIdx] : '';
    rightNum.textContent = rightIdx < totalPages ? rightIdx + 1 : '';
    
    const leftDisplay = leftIdx + 1;
    const rightDisplay = Math.min(rightIdx + 1, totalPages);
    document.getElementById('currentSpread').textContent = leftDisplay + '-' + rightDisplay;
    
    document.getElementById('prevBtn').disabled = spreadIndex === 0;
    document.getElementById('nextBtn').disabled = spreadIndex >= totalSpreads - 1;
}

function nextPage() {
    if (isAnimating || currentSpread >= totalSpreads - 1) return;
    isAnimating = true;
    
    document.getElementById('rightPage').classList.add('flipping');
    
    setTimeout(() => {
        currentSpread++;
        displaySpread(currentSpread);
        document.getElementById('rightPage').classList.remove('flipping');
        isAnimating = false;
    }, 600);
}

function prevPage() {
    if (isAnimating || currentSpread <= 0) return;
    isAnimating = true;
    
    const leftPage = document.getElementById('leftPage');
    leftPage.style.transform = 'rotateY(-180deg)';
    leftPage.classList.add('flipping-back');
    
    setTimeout(() => {
        currentSpread--;
        displaySpread(currentSpread);
        leftPage.style.transform = '';
        leftPage.classList.remove('flipping-back');
        isAnimating = false;
    }, 600);
}

document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowRight') nextPage();
    else if (e.key === 'ArrowLeft') prevPage();
});

function exportToPDF() {
    const loading = document.getElementById('loadingOverlay');
    loading.classList.add('active');
    
    let pdfHTML = '<div style="font-family:Georgia,serif;">';
    pageContents.forEach((content, i) => {
        pdfHTML += `<div style="page-break-after:always;padding:30px;min-height:100vh;">${content}</div>`;
    });
    pdfHTML += '</div>';
    
    const pdfContainer = document.getElementById('pdfContent');
    pdfContainer.innerHTML = pdfHTML;
    pdfContainer.style.display = 'block';
    
    html2pdf().set({
        margin: 0.4,
        filename: 'PayFlow_User_Manual.pdf',
        image: { type: 'jpeg', quality: 0.95 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'landscape' }
    }).from(pdfContainer).save().then(() => {
        pdfContainer.style.display = 'none';
        loading.classList.remove('active');
    });
}

window.onload = initBook;
</script>

</body>
</html>
